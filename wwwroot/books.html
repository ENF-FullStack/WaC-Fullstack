<!DOCTYPE HTML>
<html lang="en">  
<head>
    <meta charset="utf-8" />
    <title>Book application</title>
    <link rel="shortcut icon" href="images/bookicon.jpg" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="/libs/bootstrap/dist/css/bootstrap.css" rel="stylesheet">
	<link href="/styles/books.css" rel="stylesheet">
    <script src="/libs/jquery.js"></script>
    <script src="/libs/bootstrap/dist/js/bootstrap.js"></script>
    <script src="/scripts/books.js"></script>
</head>
<body>  
	<div class="container">
		<header class="row">
            <div class="col-md-2">
                <img src="/images/books.gif" />
            </div>
			<h1 class="col-md-10">Book application</h1>
		</header>
		<main>
            <div id="errorDiv" data-joku="asdfas">
                <p>Tähän virheet</p>
                <input id="nappi" type="button" value="Clickaa" />
            </div>
		  <form action="/formdata" method="post" class="container" id="myform" >
			<div class="row">
				<div class="col-md-4">
					<div class="form-group">
						<label for="title">Title</label>
						<input class="form-control" type="text" id="title" name="title"/>
					</div>
					<div class="form-group">
						<label for="author">Author</label>
						<input class="form-control" type="text" id="author" name="author"/>
					</div>
					<div class="form-group">
						<label id="test" for="description">Description</label>
						<textarea class="form-control" id="description" name="description"></textarea>
					</div>
                </div>
                <div class="col-md-4">
                    <select id="books" class="form-control" size="10" >
                        <option data-book='{"title":"Hobbit","author":"Tolkien","description":"There and back"}'>Hobbit, Tolkien</option>
                    </select>
                </div>
                <div id="explanations" class="col-md-4">
                    <section id="pageLoaded">
                        <h2>Page is loaded</h2>
                        <p>When page is loaded, window.onload -event handler (the topmost function in books.js)
                            is executed. The onload-handler registers event-handlers for other events and
                            calls fillList-function that:</p>
                            <ul>
                                <li>Fetches books from the server</li>
                                <li>Loops through the books and populates the select-field with them</li>
                            </ul>
                    </section>
                    <section id="submitClicked" class="d-none">
                        <h2>Submit (save) clicked</h2>
                        <p>Now the submit handler of the form is executed. It verifies the data entered
                            and if everything is ok (title and author contain data) a book object is 
                            created.</p>
                        <p>Originally we just added the book to the select-field, but now we send the book
                            to the server, query all the books from the server again and repopulate the 
                            select field.</p>
                        <p>If nothing is selected from the select-field a new book is created,
                            otherwise changes to an existing book are saved.</p>
                    </section>
                    <section id="bookSelected" class="d-none">
                        <h2>Book is selected</h2>
                        <p>Event handler for the select field's change-event is executed.</p>
                        <p>As the the option elements where created we stored book in JSON-format
                            to data-book -attribute of the option element. Now we read the attribute from
                            the selected book, convert it back to actual JavaScript-object and place the
                            data into the edit fields.
                        </p>
                    </section>
                    <section id="newBookClicked" class="d-none">
                        <h2>New book?</h2>
                        <p>Click- handler for "New"-button is executed.</p>
                        <p>We don't actually create a book yet. We just clear the input 
                            fields and selection from the select-field so that when 
                            save is clicked later on, it will create a new book.
                        </p> 
                    </section>
                    <section id="deleteClicked" class="d-none">
                        <h2>Delete</h2>
                        <p>Now we execute click handler of the Delete-button.</p>
                        <p>If a book is selected we make a request to the server to
                            delete the book and then query all the books from the server
                            again to repopulate the select field.</p>
                    </section>
                </div>
            </div>
            <div class="buttons row" style="margin-top: 10px">
                <div class="col-md-4" style="text-align: center;">
                    <input id="submit" class="btn btn-primary" type="submit" value="Save"/>
                    <input class="btn btn-secondary" type="button" value="Cancel" />
                </div>
                <div class="col-md-4" style="text-align: center;">
                    <input id="newBook" class="btn btn-secondary" type="button" value="New" />
                    <input id="delete" class="btn btn-secondary" type="button" value="Delete" />
                </div>
                <div class="col-md-4">

                </div>
            </div>
		  </form>
		</main>
		<footer class="row small">
            <p class="col-md-6">Copyright (c) Kooditutorit Konsultointi Oy, 2021</p>
			<a class="col-md-3" href="http://www.kooditutorit.fi">www.kooditutorit.fi</a>
			<a class="col-md-3 text-right" href="mailto:info@kooditutorit.fi">info@kooditutorit.fi</a>
		</footer>
	</div>
</body>
</html> 
